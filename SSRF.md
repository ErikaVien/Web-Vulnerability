## SSRF (Server-side Request Forgery）服务端请求伪造
### SSRF
- 由攻击者伪造形成由服务端发起请求的一个安全漏洞
- 除了curl, 其他PHP函数可引起的SSRF漏洞：curl_exec(), file_get_content(), fsockopen(),file()

### 利用php curl extension：
1. 获取网页资源 - 爬虫
2. 获取接口数据 - webservice
3. 下载文件 - ftp

extension in php.ini  - php_curl.dll

curl : 执行http请求，或ftp,https,telnet等请求

### curl其他协议：
1. dict - 塔建在线字典服务- 用来探测端口
2. gopher - 一种信息查找系统，只支持文本，已被http代替 - 反弹shell
3. file - 查看文件

### SSRF危害：
1. 扫描资产
2. 获取敏感信息
3. 攻击内网服务器（绕过WAF）
4. 访问文件
5. 通过Redis 或 gopher写入webshell或建立反弹连接

### 常用的场景：
- 社会化的分享功能
- 转码服务
- 在线翻译
- 图片加载，下载功能
- 图片，文章收藏功能
- 网站采集，网站抓取

### 如何发现SSRF漏洞：
1. 爬取地址 - url 里有url参数 : http://xxx.com?url=http://baidu.com
2. 查看是否请求了其他资源
- 可以使用Google语法搜索关键字:  inurl:

share, wap, link, url, source, src, target, display, etc

- 工具：Github：SSRF-Testing, Gopherus

### SSRF防御：
1. 禁用协议：如dict, gopher,file
2. 限制请求端口： 只能访问某个端口
3. 设置白名单： 只能访问目录下的某个内容，地址之外的不能访问
4. 过滤返回信息：请求得到但不返回敏感的内容
5. 统一错误信息：封装报错信息，服务端报错了客服端看不到
